<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css">
    <script src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.21.4/dist/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script type="text/javascript" src="https://unpkg.com/table2excel@1.0.4/dist/table2excel.js"></script>
  </head>
  <body>
 <!-- Write your comments here -->
 <nav class="navbar navbar-dark bg-dark">
    <!-- Navbar content -->
    <a class="navbar-brand" href="#">
        <img src="https://swimburger.net/media/fbqnp2ie/azure.svg" width="50" height="30" alt="">
        Azure Price Cost Estimation Tool 
        <div class="spinner-border" role="status" style="visibility: hidden;" id="loading">
        </div>
        <button type="button" class="btn btn-info" id="Startsearch" onclick="search()" value="Start Search">Start Search</button>
        <button type="button" class="btn btn-success" id="Startsearch" onclick="exporttable()" value="Start Search">Export Excel File</button>
    </a>
    
    <a class="navbar-brand" href="#">Bata v1.0.0
      
    </a>
   </nav>
 <!-- sidebar content -->
 <div class="mx-auto" style="width: auto;margin-top: 2%;">
 <div class="container" style="max-width:none;width: 100%;margin-left:0%;margin-right:0%">
  <div class="row" style="width: 100%">
    <div class="col-2" style="width: 25%">
   <div class="nav flex-column nav-pills " id="v-pills-tab" role="tablist" aria-orientation="vertical" >
    <a class="nav-link active bg-dark text-white" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">
      <img src="http://code.benco.io/icon-collection/azure-icons/Virtual-Machine.svg" width="50" height="30" alt="">
      Virtual Machine
    </a>
    <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">
      <img src="http://code.benco.io/icon-collection/azure-icons/Virtual-Machine.svg" width="50" height="30" alt="">
      Virtual Machine License (Windows Type)
    </a>
    <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab" aria-controls="v-pills-messages" aria-selected="false">
      <img src="http://code.benco.io/icon-collection/azure-icons/Virtual-Machine.svg" width="50" height="30" alt="">
      Virtual Machine License (Linux Type)
    </a>
    <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab" aria-controls="v-pills-settings" aria-selected="false">Settings</a>
  </div>
</div>
  <div class="col-10" style="width: 75%">
  <div class="tab-content" id="v-pills-tabContent">
  <!-- Virtual Machine -->   
    <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
       <!-- form content -->
        <div class="mx-auto" style="width: auto;">
          <div class="p-3 mb-2 bg-secondary text-white">
            <div class="container">
              <div class="grey-bg container-fluid">
                <section id="minimal-statistics">
                  <div class="row">
                    <div class="col-12 mt-3 mb-1">
                      <h4 class="text-uppercase"></h4>
                     
                    </div>
                  </div>
                  <div class="row">
                    <div class="table-responsive mx-auto" style="width: auto;height:500px" id="tablelist1">
                      </div>
                  </div>
                </section>
                <!-- loading -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
      <button type="button" class="btn btn-info" id="windowlicenseID" onclick="windowlicense()" value="Start Search">Show Window License Cost</button>
      <div class="spinner-border" role="status" style="visibility: hidden;width: 100px; height: 100px;" id="loading1" >
      </div>
      <div class="table-responsive mx-auto" style="width: auto;height:500px" id="tablelistVM">
        <table id="jsonTableVM" data-excel-name="Windows License Table" class="table table-hover"><thead><tr></tr></thead><tbody></tbody></table>
      </div>



    </div>
    <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
      <button type="button" class="btn btn-info" id="linuxlicenseID" onclick="linuxlicense()" value="Start Search">Show Linux License Cost</button>
      <div class="spinner-border" role="status" style="visibility: hidden;width: 100px; height: 100px;" id="loading2" >
      </div>
      <div class="table-responsive mx-auto" style="width: auto;height:500px" id="tablelistVM1">
        <table id="jsonTableVM1" data-excel-name="Linux License Table" class="table table-hover"><thead><tr></tr></thead><tbody></tbody></table>
      </div>

      
    </div>
    <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">...</div>
  </div>
</div>
</div>
</div>
</div>



 <!-- tab navbar -->
   <ul class="nav nav-tabs" id="myTab" role="tablist">
     <!-- tab navbar item-->
    <li class="nav-item" role="presentation">
      <button 
        class="nav-link active" 
        id="home-tab" 
        data-bs-toggle="tab" 
        data-bs-target="#home" 
        type="button" 
        role="tab" 
        aria-controls="home" 
        aria-selected="true">
      Table View
      </button>
    </li>

    <li class="nav-item" role="presentation">
      <button 
        class="nav-link" 
        id="profile-tab" 
        data-bs-toggle="tab" 
        data-bs-target="#profile" 
        type="button" 
        role="tab" 
        aria-controls="profile" 
        aria-selected="false">
      Graph View
    </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">JSON View</button>
    </li>
  </ul>
   <!-- tab content -->
  <div class="tab-content" id="myTabContent">
    <div 
      class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
      <div class="table-responsive mx-auto" style="width: auto;" id="tablelist">
        <table id="jsonTable" data-excel-name="Azure VM Comparison Table" class="table table-hover"><thead><tr></tr></thead><tbody></tbody></table>
      </div>
    </div>
    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
TBC
    </div>
    <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
      <iframe id="iframe_id" src="url" title="description" onload="this.width=screen.width;this.height=screen.height;"></iframe>
    </div>
  </div>
  






<!-- Write your comments here -->
  
<script>
  
// Table Generation Start
const VMSP=[
 {
   "FIELD1": 1,
   "0.5": "Standard_B1ls",
   "0.75": "Basic_A0 ,Standard_A0",
   "1": "Standard_B1s",
   "1.75": "Basic_A1 ,Standard_A1",
   "2": "Standard_A1_v2 ,Standard_B1ms ,Standard_F1 ,Standard_F1s",
   "3.5": "Standard_D1 ,Standard_D1_v2 ,Standard_DS1 ,Standard_DS1_v2",
   "4": "",
   "7": "",
   "8": "",
   "14": "Standard_DS11-1_v2",
   "16": "",
   "28": "Standard_DS12-1_v2",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 2,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "Basic_A2 ,Standard_A2",
   "4": "Standard_A2_v2 ,Standard_B2s ,Standard_D2plds_v5 ,Standard_D2pls_v5 ,Standard_F2 ,Standard_F2s ,Standard_F2s_v2",
   "7": "Standard_D2 ,Standard_D2_v2 ,Standard_DS2 ,Standard_DS2_v2",
   "8": "Standard_B2ms ,Standard_D2_v3 ,Standard_D2_v4 ,Standard_D2_v5 ,Standard_D2a_v4 ,Standard_D2ads_v5 ,Standard_D2as_v4 ,Standard_D2as_v5 ,Standard_D2d_v4 ,Standard_D2d_v5 ,Standard_D2ds_v4 ,Standard_D2ds_v5 ,Standard_D2pds_v5 ,Standard_D2ps_v5 ,Standard_D2s_v3 ,Standard_D2s_v4 ,Standard_D2s_v5",
   "14": "Standard_A5 ,Standard_D11 ,Standard_D11_v2 ,Standard_DS11 ,Standard_DS11_v2",
   "16": "Standard_A2m_v2 ,Standard_E2_v3 ,Standard_E2_v4 ,Standard_E2_v5 ,Standard_E2a_v4 ,Standard_E2ads_v5 ,Standard_E2as_v4 ,Standard_E2as_v5 ,Standard_E2bds_v5 ,Standard_E2bs_v5 ,Standard_E2d_v4 ,Standard_E2d_v5 ,Standard_E2ds_v4 ,Standard_E2ds_v5 ,Standard_E2pds_v5 ,Standard_E2ps_v5 ,Standard_E2s_v3 ,Standard_E2s_v4 ,Standard_E2s_v5",
   "28": "Standard_DS12-2_v2",
   "32": "Standard_E4-2ads_v5 ,Standard_E4-2as_v4 ,Standard_E4-2as_v5 ,Standard_E4-2ds_v4 ,Standard_E4-2ds_v5 ,Standard_E4-2s_v3 ,Standard_E4-2s_v4 ,Standard_E4-2s_v5",
   "48": "",
   "56": "Standard_DS13-2_v2",
   "64": "Standard_E8-2ads_v5 ,Standard_E8-2as_v4 ,Standard_E8-2as_v5 ,Standard_E8-2ds_v4 ,Standard_E8-2ds_v5 ,Standard_E8-2s_v3 ,Standard_E8-2s_v4 ,Standard_E8-2s_v5",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "Standard_M8-2ms",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 4,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "Basic_A3 ,Standard_A3",
   "8": "Standard_A4_v2 ,Standard_D4plds_v5 ,Standard_D4pls_v5 ,Standard_F4 ,Standard_F4s ,Standard_F4s_v2",
   "14": "Standard_D3 ,Standard_D3_v2 ,Standard_DS3 ,Standard_DS3_v2",
   "16": "Standard_B4ms ,Standard_D4_v3 ,Standard_D4_v4 ,Standard_D4_v5 ,Standard_D4a_v4 ,Standard_D4ads_v5 ,Standard_D4as_v4 ,Standard_D4as_v5 ,Standard_D4d_v4 ,Standard_D4d_v5 ,Standard_D4ds_v4 ,Standard_D4ds_v5 ,Standard_D4pds_v5 ,Standard_D4ps_v5 ,Standard_D4s_v3 ,Standard_D4s_v4 ,Standard_D4s_v5",
   "28": "Standard_A6 ,Standard_D12 ,Standard_D12_v2 ,Standard_DS12 ,Standard_DS12_v2",
   "32": "Standard_A4m_v2 ,Standard_E4_v3 ,Standard_E4_v4 ,Standard_E4_v5 ,Standard_E4a_v4 ,Standard_E4ads_v5 ,Standard_E4as_v4 ,Standard_E4as_v5 ,Standard_E4bds_v5 ,Standard_E4bs_v5 ,Standard_E4d_v4 ,Standard_E4d_v5 ,Standard_E4ds_v4 ,Standard_E4ds_v5 ,Standard_E4pds_v5 ,Standard_E4ps_v5 ,Standard_E4s_v3 ,Standard_E4s_v4 ,Standard_E4s_v5",
   "48": "",
   "56": "Standard_DS13-4_v2",
   "64": "Standard_E8-4ads_v5 ,Standard_E8-4as_v4 ,Standard_E8-4as_v5 ,Standard_E8-4ds_v4 ,Standard_E8-4ds_v5 ,Standard_E8-4s_v3 ,Standard_E8-4s_v4 ,Standard_E8-4s_v5",
   "80": "",
   "96": "",
   "112": "Standard_DS14-4_v2",
   "128": "Standard_E16-4ads_v5 ,Standard_E16-4as_v4 ,Standard_E16-4as_v5 ,Standard_E16-4ds_v4 ,Standard_E16-4ds_v5 ,Standard_E16-4s_v3 ,Standard_E16-4s_v4 ,Standard_E16-4s_v5",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "Standard_M8-4ms",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "Standard_M16-4ms",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 6,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "Standard_NC6s_v3",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 8,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "Basic_A4 ,Standard_A4",
   "16": "Standard_A8_v2 ,Standard_D8plds_v5 ,Standard_D8pls_v5 ,Standard_F8 ,Standard_F8s ,Standard_F8s_v2",
   "28": "Standard_D4 ,Standard_D4_v2 ,Standard_DS4 ,Standard_DS4_v2",
   "32": "Standard_B8ms ,Standard_D8_v3 ,Standard_D8_v4 ,Standard_D8_v5 ,Standard_D8a_v4 ,Standard_D8ads_v5 ,Standard_D8as_v4 ,Standard_D8as_v5 ,Standard_D8d_v4 ,Standard_D8d_v5 ,Standard_D8ds_v4 ,Standard_D8ds_v5 ,Standard_D8pds_v5 ,Standard_D8ps_v5 ,Standard_D8s_v3 ,Standard_D8s_v4 ,Standard_D8s_v5",
   "48": "",
   "56": "Standard_A7 ,Standard_D13 ,Standard_D13_v2 ,Standard_DS13 ,Standard_DS13_v2",
   "64": "Standard_A8m_v2 ,Standard_E8_v3 ,Standard_E8_v4 ,Standard_E8_v5 ,Standard_E8a_v4 ,Standard_E8ads_v5 ,Standard_E8as_v4 ,Standard_E8as_v5 ,Standard_E8bds_v5 ,Standard_E8bs_v5 ,Standard_E8d_v4 ,Standard_E8d_v5 ,Standard_E8ds_v4 ,Standard_E8ds_v5 ,Standard_E8pds_v5 ,Standard_E8ps_v5 ,Standard_E8s_v3 ,Standard_E8s_v4 ,Standard_E8s_v5 ,Standard_L8as_v3 ,Standard_L8s_v3",
   "80": "",
   "96": "",
   "112": "Standard_DS14-8_v2",
   "128": "Standard_E16-8ads_v5 ,Standard_E16-8as_v4 ,Standard_E16-8as_v5 ,Standard_E16-8ds_v4 ,Standard_E16-8ds_v5 ,Standard_E16-8s_v3 ,Standard_E16-8s_v4 ,Standard_E16-8s_v5",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "Standard_M8ms",
   "224": "",
   "256": "Standard_E32-8ads_v5 ,Standard_E32-8as_v4 ,Standard_E32-8ds_v4 ,Standard_E32-8ds_v5 ,Standard_E32-8s_v3 ,Standard_E32-8s_v4 ,Standard_E32-8s_v5",
   "384": "",
   "432": "",
   "437.5": "Standard_M16-8ms",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "Standard_M32-8ms",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 12,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "Standard_B12ms",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "Standard_NC12s_v3",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 16,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "Standard_D16plds_v5 ,Standard_D16pls_v5 ,Standard_F16 ,Standard_F16s ,Standard_F16s_v2",
   "48": "",
   "56": "Standard_D5_v2 ,Standard_DS5_v2",
   "64": "Standard_B16ms ,Standard_D16_v3 ,Standard_D16_v4 ,Standard_D16_v5 ,Standard_D16a_v4 ,Standard_D16ads_v5 ,Standard_D16as_v4 ,Standard_D16as_v5 ,Standard_D16d_v4 ,Standard_D16d_v5 ,Standard_D16ds_v4 ,Standard_D16ds_v5 ,Standard_D16pds_v5 ,Standard_D16ps_v5 ,Standard_D16s_v3 ,Standard_D16s_v4 ,Standard_D16s_v5",
   "80": "",
   "96": "",
   "112": "Standard_D14 ,Standard_D14_v2 ,Standard_DS14 ,Standard_DS14_v2",
   "128": "Standard_E16_v3 ,Standard_E16_v4 ,Standard_E16_v5 ,Standard_E16a_v4 ,Standard_E16ads_v5 ,Standard_E16as_v4 ,Standard_E16as_v5 ,Standard_E16bds_v5 ,Standard_E16bs_v5 ,Standard_E16d_v4 ,Standard_E16d_v5 ,Standard_E16ds_v4 ,Standard_E16ds_v5 ,Standard_E16pds_v5 ,Standard_E16ps_v5 ,Standard_E16s_v3 ,Standard_E16s_v4 ,Standard_E16s_v5 ,Standard_L16as_v3 ,Standard_L16s_v3",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "Standard_E32-16ads_v5 ,Standard_E32-16as_v4 ,Standard_E32-16as_v5 ,Standard_E32-16ds_v4 ,Standard_E32-16ds_v5 ,Standard_E32-16s_v3 ,Standard_E32-16s_v4 ,Standard_E32-16s_v5",
   "384": "",
   "432": "Standard_E64-16s_v3",
   "437.5": "Standard_M16ms",
   "448": "",
   "504": "Standard_E64-16ds_v4 ,Standard_E64-16s_v4",
   "512": "Standard_E64-16ads_v5 ,Standard_E64-16as_v4 ,Standard_E64-16as_v5 ,Standard_E64-16ds_v5 ,Standard_E64-16s_v5",
   "640": "",
   "672": "",
   "875": "Standard_M32-16ms",
   "1000": "",
   "1024": "",
   "1750": "Standard_M64-16ms",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 20,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "Standard_B20ms",
   "96": "",
   "112": "",
   "128": "",
   "140": "Standard_D15_v2 ,Standard_DS15_v2",
   "144": "",
   "160": "Standard_E20_v3 ,Standard_E20_v4 ,Standard_E20_v5 ,Standard_E20a_v4 ,Standard_E20ads_v5 ,Standard_E20as_v4 ,Standard_E20as_v5 ,Standard_E20d_v4 ,Standard_E20d_v5 ,Standard_E20ds_v4 ,Standard_E20ds_v5 ,Standard_E20pds_v5 ,Standard_E20ps_v5 ,Standard_E20s_v3 ,Standard_E20s_v4 ,Standard_E20s_v5",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 24,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "Standard_NC24rs_v3 ,Standard_NC24s_v3",
   "504": "",
   "512": "",
   "640": "",
   "672": "Standard_E96-24ads_v5 ,Standard_E96-24as_v4 ,Standard_E96-24as_v5 ,Standard_E96-24ds_v5 ,Standard_E96-24s_v5",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 32,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "Standard_D32plds_v5 ,Standard_D32pls_v5 ,Standard_F32s_v2",
   "80": "",
   "96": "",
   "112": "",
   "128": "Standard_D32_v3 ,Standard_D32_v4 ,Standard_D32_v5 ,Standard_D32a_v4 ,Standard_D32ads_v5 ,Standard_D32as_v4 ,Standard_D32as_v5 ,Standard_D32d_v4 ,Standard_D32d_v5 ,Standard_D32ds_v4 ,Standard_D32ds_v5 ,Standard_D32pds_v5 ,Standard_D32ps_v5 ,Standard_D32s_v3 ,Standard_D32s_v4 ,Standard_D32s_v5",
   "140": "",
   "144": "",
   "160": "",
   "192": "Standard_M32ts",
   "208": "Standard_E32pds_v5 ,Standard_E32ps_v5",
   "218.75": "",
   "224": "",
   "256": "Standard_E32_v3 ,Standard_E32_v4 ,Standard_E32_v5 ,Standard_E32a_v4 ,Standard_E32ads_v5 ,Standard_E32as_v4 ,Standard_E32as_v5 ,Standard_E32bds_v5 ,Standard_E32bs_v5 ,Standard_E32d_v4 ,Standard_E32d_v5 ,Standard_E32ds_v4 ,Standard_E32ds_v5 ,Standard_E32s_v3 ,Standard_E32s_v4 ,Standard_E32s_v5 ,Standard_L32as_v3 ,Standard_L32s_v3 ,Standard_M32ls",
   "384": "",
   "432": "Standard_E64-32s_v3",
   "437.5": "",
   "448": "",
   "504": "Standard_E64-32ds_v4 ,Standard_E64-32s_v4",
   "512": "Standard_E64-32ads_v5 ,Standard_E64-32as_v4 ,Standard_E64-32as_v5 ,Standard_E64-32ds_v5 ,Standard_E64-32s_v5",
   "640": "",
   "672": "",
   "875": "Standard_M32dms_v2 ,Standard_M32ms ,Standard_M32ms_v2",
   "1000": "",
   "1024": "",
   "1750": "Standard_M64-32ms",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "Standard_M128-32ms",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 48,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "Standard_D48plds_v5 ,Standard_D48pls_v5 ,Standard_F48s_v2",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "Standard_D48_v3 ,Standard_D48_v4 ,Standard_D48_v5 ,Standard_D48a_v4 ,Standard_D48ads_v5 ,Standard_D48as_v4 ,Standard_D48as_v5 ,Standard_D48d_v4 ,Standard_D48d_v5 ,Standard_D48ds_v4 ,Standard_D48ds_v5 ,Standard_D48pds_v5 ,Standard_D48ps_v5 ,Standard_D48s_v3 ,Standard_D48s_v4 ,Standard_D48s_v5",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "Standard_E48_v3 ,Standard_E48_v4 ,Standard_E48_v5 ,Standard_E48a_v4 ,Standard_E48ads_v5 ,Standard_E48as_v4 ,Standard_E48as_v5 ,Standard_E48bds_v5 ,Standard_E48bs_v5 ,Standard_E48d_v4 ,Standard_E48d_v5 ,Standard_E48ds_v4 ,Standard_E48ds_v5 ,Standard_E48s_v3 ,Standard_E48s_v4 ,Standard_E48s_v5 ,Standard_L48as_v3 ,Standard_L48s_v3",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "Standard_E96-48ads_v5 ,Standard_E96-48as_v4 ,Standard_E96-48as_v5 ,Standard_E96-48ds_v5 ,Standard_E96-48s_v5",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 64,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "Standard_D64plds_v5 ,Standard_D64pls_v5 ,Standard_F64s_v2",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "Standard_D64pds_v5 ,Standard_D64ps_v5",
   "218.75": "",
   "224": "",
   "256": "Standard_D64_v3 ,Standard_D64_v4 ,Standard_D64_v5 ,Standard_D64a_v4 ,Standard_D64ads_v5 ,Standard_D64as_v4 ,Standard_D64as_v5 ,Standard_D64d_v4 ,Standard_D64d_v5 ,Standard_D64ds_v4 ,Standard_D64ds_v5 ,Standard_D64s_v3 ,Standard_D64s_v4 ,Standard_D64s_v5",
   "384": "",
   "432": "Standard_E64_v3 ,Standard_E64i_v3 ,Standard_E64is_v3 ,Standard_E64s_v3",
   "437.5": "",
   "448": "",
   "504": "Standard_E64_v4 ,Standard_E64d_v4 ,Standard_E64ds_v4 ,Standard_E64s_v4",
   "512": "Standard_E64_v5 ,Standard_E64a_v4 ,Standard_E64ads_v5 ,Standard_E64as_v4 ,Standard_E64as_v5 ,Standard_E64bds_v5 ,Standard_E64bs_v5 ,Standard_E64d_v5 ,Standard_E64ds_v5 ,Standard_E64s_v5 ,Standard_L64as_v3 ,Standard_L64s_v3 ,Standard_M64ls",
   "640": "",
   "672": "",
   "875": "",
   "1000": "Standard_M64",
   "1024": "Standard_M64ds_v2 ,Standard_M64s ,Standard_M64s_v2",
   "1750": "Standard_M64m ,Standard_M64ms",
   "1792": "Standard_M64dms_v2 ,Standard_M64ms_v2",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "Standard_M128-64ms",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 72,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "Standard_F72s_v2",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 80,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "Standard_E80ids_v4 ,Standard_E80is_v4",
   "512": "",
   "640": "Standard_L80as_v3 ,Standard_L80s_v3",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 96,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "Standard_D96_v5 ,Standard_D96a_v4 ,Standard_D96ads_v5 ,Standard_D96as_v4 ,Standard_D96as_v5 ,Standard_D96d_v5 ,Standard_D96ds_v5 ,Standard_D96s_v5",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "Standard_E96_v5 ,Standard_E96a_v4 ,Standard_E96ads_v5 ,Standard_E96as_v4 ,Standard_E96as_v5 ,Standard_E96d_v5 ,Standard_E96ds_v5 ,Standard_E96s_v5",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 104,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "Standard_E104i_v5 ,Standard_E104id_v5 ,Standard_E104ids_v5 ,Standard_E104is_v5",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 112,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "Standard_E112iads_v5 ,Standard_E112ias_v5",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 128,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "Standard_M128 ,Standard_M128s",
   "2048": "Standard_M128ds_v2 ,Standard_M128s_v2",
   "2850": "",
   "3800": "Standard_M128m ,Standard_M128ms",
   "3892": "Standard_M128dms_v2 ,Standard_M128ms_v2",
   "4096": "",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 192,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "Standard_M192ids_v2 ,Standard_M192is_v2",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "Standard_M192idms_v2 ,Standard_M192ims_v2",
   "5700": "",
   "11400": ""
 },
 {
   "FIELD1": 208,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "Standard_M208s_v2",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "Standard_M208ms_v2 ,Standard_M416-208s_v2",
   "11400": "Standard_M416-208ms_v2"
 },
 {
   "FIELD1": 416,
   "0.5": "",
   "0.75": "",
   "1": "",
   "1.75": "",
   "2": "",
   "3.5": "",
   "4": "",
   "7": "",
   "8": "",
   "14": "",
   "16": "",
   "28": "",
   "32": "",
   "48": "",
   "56": "",
   "64": "",
   "80": "",
   "96": "",
   "112": "",
   "128": "",
   "140": "",
   "144": "",
   "160": "",
   "192": "",
   "208": "",
   "218.75": "",
   "224": "",
   "256": "",
   "384": "",
   "432": "",
   "437.5": "",
   "448": "",
   "504": "",
   "512": "",
   "640": "",
   "672": "",
   "875": "",
   "1000": "",
   "1024": "",
   "1750": "",
   "1792": "",
   "2000": "",
   "2048": "",
   "2850": "",
   "3800": "",
   "3892": "",
   "4096": "",
   "5700": "Standard_M416s_v2",
   "11400": "Standard_M416ms_v2"
 }
]

const removeEmptyOrNull = (obj) => {
 Object.keys(obj).forEach(k =>
   (obj[k] && typeof obj[k] === 'object') && removeEmptyOrNull(obj[k]) ||
   (!obj[k] && obj[k] !== undefined) && delete obj[k]
 );
 return obj;
};

myObj2 = removeEmptyOrNull(VMSP);

function drawTable(data) {
  $('#tablelist1').append(
  '<div class="form-check form-switch" > <input class="form-check-input" name="'+
    data[0].FIELD1+"vCPU"
        +'" type="checkbox" id="'
          + data[0].FIELD1+"vCPU"+
          '" onClick="toggle(this,\''+ data[0].FIELD1+"vCPU"+
          '\')"> <label class="form-check-label" for="'
          + data[0].FIELD1+"vCPU"+'">'+data[0].FIELD1+' vCPU'+'</label> </div>'
  
  )
  // Get Table headers and print
  $('#tablelist1').append('<table id="VMtable'+data[0].FIELD1+'" class="table table-hover" data-filter-control="true" data-search="false" data-advanced-search="false" ><thead><tr></tr></thead><tbody></tbody></table>');

  var list=[]
  for (var j = 0; j < Object.keys(data[0]).length; j++) {
    if(Object.keys(data[0])[j]!="FIELD1"){
    list.push(Object.keys(data[0])[j])
    }
  }
  list.sort((a, b) => a.localeCompare(b, undefined, { numeric: true }))
  for(var j=0;j<list.length;j++){
    if(list[j]!="FIELD1"){
      $('#VMtable'+data[0].FIELD1+' thead tr').append(`<th data-field="`+
      list[j]
      +`" data-filter-control="select">` +
        '<div class="form-check form-switch"> <input class="form-check-input" name="'+
          data[0].FIELD1+"vCPU"
        +'" type="checkbox" id="'
          + data[0].FIELD1+"vCPU"+list[j]+"RAM"+
          '" onClick="toggle(this,\''+ data[0].FIELD1+"vCPU"+list[j]+"RAM"+
          '\')"> <label class="form-check-label" for="'
          + data[0].FIELD1+"vCPU"+list[j]+"RAM"+'">'+list[j] +" RAM "
          +'</label> </div>'
        + '</th>');
    }  
  }
  // Print the content of rows in DataTable
  for (var i = 0; i < data.length; i++) {
    drawRow(data[i],list);
  }
}
function toggle(source,name) {
  checkboxes = document.querySelectorAll('[name^="'+name+'"]')
  for(var i=0, n=checkboxes.length;i<n;i++){
    checkboxes[i].checked = source.checked;
  };
}


function drawRow(rowData,list) {
  var row = '<tr>';
 // $("#tablelist1").append(row);
  for (var j = 0; j < list.length; j++) {
    rowContent=""
    for (var p = 0; p < rowData[list[j]].split(',').length; p++) {
      rowContent+='<div class="form-check form-switch"><input class="form-check-input" name="'+
        rowData.FIELD1+"vCPU"+list[j]+"RAM"
        +'" type="checkbox" id="'+
      rowData[list[j]].split(',')[p]
      +'" autocomplete="off"><label class="form-check-label" for="'+
      rowData[list[j]].split(',')[p]
      +'">';
      rowContent+=rowData[list[j]].split(',')[p]
      rowContent+="</label></div>";
    }
    row += "<td>" + rowContent + "</td>";
  };
  row+= "</tr>";
  $('#VMtable'+rowData.FIELD1+' tbody').append(row);
}
for (let i = 0; i < myObj2.length; i++) {
  drawTable([myObj2[i]]);
}
// Table Generation End

//Result Table Generation Start
function createTable(object,divID,tableID,exceltablename){
	$('#'+divID+'').append('<table id="'+tableID+'" data-excel-name="'+exceltablename+'" class="table table-hover" data-filter-control="true" data-search="false" data-advanced-search="false"><thead><tr></tr></thead><tbody></tbody></table>');
  $.each(Object.keys(object[0]), function(index, key){
    $('#'+tableID+' thead tr').append(`<th data-field="`+key+`" data-filter-control="select" data-filter-control-multiple-select="true">` + 
      keyVaule(key)
      + '</th>');
  });	
  $.each(object, function(index, jsonObject){     
    if(Object.keys(jsonObject).length > 0){
      var tableRow = '<tr>';
      $.each(Object.keys(jsonObject), function(i, key){
         tableRow += '<td>' + jsonObject[key] + '</td>';
      });
      tableRow += "</tr>";
      $('#'+tableID+' tbody').append(tableRow);
    }
	});
}

function keyVaule(key){
  if(key=="unitPrice"){
      return "Unit Price $(USD)"
    }if (key=="retailPrice") {
      return "Monthly Price (730 hours) $(USD)"
    } if (key=="retailPrice1") {
      return "1 Year Price $(USD)"
    }if (key=="retailPrice2"){
      return "3 Year Price $(USD)"
    }else{
      return key
    }      
}

function query (data) {
  return _.chain(data)
  .orderBy(['armSkuName','retailPrice'], ['asc'])
    .map(item => ({
    //  "serviceFamily": item?.serviceFamily,
    //  "serviceName": item?.serviceName,
      "productName": item?.productName,
      "location": item?.location,
    // "armRegionName": item?.armRegionName,
      "armSkuName": item?.armSkuName,
    //  "skuName": item?.skuName,
     // "retailPrice": item?.retailPrice,
     "reservationTerm": 
      (item?.reservationTerm == "1 Year"||item?.reservationTerm == "3 Years" )?
      item?.reservationTerm+" Reserved Instance"
      :
      "Pay As You Go",
     // "type": item?.type ,
      
      "unitPrice": 
      (item?.reservationTerm == "1 Year" ||item?.reservationTerm == "3 Years" )?
        (item?.reservationTerm == "1 Year")?
        item?.unitPrice+" per 1 year":
        item?.unitPrice+" per 3 years":
        item?.unitPrice+" per hour"
      ,

      "retailPrice":
      (item?.type != "Consumption")?
        "":
        (Math.round((item?.retailPrice*730*100))/100).toFixed(2),

      "retailPrice1":
      (item?.reservationTerm == "1 Year" ||item?.reservationTerm == "3 Years" )?
        (item?.reservationTerm == "1 Year")?
          item?.retailPrice:
          "":
        (Math.round((item?.retailPrice*730*12*100))/100).toFixed(2),

      "retailPrice2":
      (item?.reservationTerm == "1 Year" ||item?.reservationTerm == "3 Years" )?
        (item?.reservationTerm == "1 Year")?
          (Math.round((item?.retailPrice*3*100))/100).toFixed(2):
          item?.retailPrice:
        (Math.round((item?.retailPrice*730*12*3*100))/100).toFixed(2) ,

     // "unitOfMeasure": item?.unitOfMeasure,
      //"currencyCode": item?.currencyCode,

    }))
    .value()
}
//Result Table Generation End 

//CORS Proxy Start
function search(){
$(document).ready(function(){
    document.getElementById("Startsearch").disabled = true;
    document.getElementById("Startsearch").className="btn btn-dark";
    document.getElementById("Startsearch").innerHTML="Searching";
    document.getElementById("loading").style.visibility='visible'
    const AzurePriceLink = "https://prices.azure.com/api/retail/prices?api-version=2023-01-01-preview&currencyCode='USD'&$filter="
    const serviceFamily = "serviceName eq 'Virtual Machines'"
    const priceType = "priceType ne 'DevTestConsumption'"  
    const armRegionName = "armRegionName eq 'eastasia'"  
    const meterName = "contains(meterName, 'Spot') eq false"
  //  const productName = "contains(productName, 'Windows') eq false"
    const skuName = "contains(skuName, 'Low Priority') eq false"        
    const SelectedVM=$('input:checked').map(function(){if(this.id.startsWith("Standard_") || this.id.startsWith("Basic_")){return this.id;}}).get().join(",").replace( /\s/g, '').split(",") 
    const SelectedVMs="(armSkuName eq '"+SelectedVM.join("' or armSkuName eq '")+"')"
    const url = AzurePriceLink.concat([
                                      priceType,
                                      serviceFamily,
                                      armRegionName,
                                      meterName,
                                      skuName,
                                //      productName,
                                      SelectedVMs
                                      ].join(' and '))
    alert(url)
            if(true){

            
    const cors = 'https://header-9dvg.onrender.com/';
    document.getElementById("jsonTable").remove();
    $.get(`${cors}${url}`, (res) => {
        const object1 = query(res.Items)
        $(document).ready(function(){
          createTable(object1,"tablelist","jsonTable","Azure VM Comparison Table");
          $('#jsonTable').bootstrapTable()
        });
        document.getElementById("loading").style.visibility='hidden';
      });
    document.getElementById("iframe_id").src=url
    document.getElementById("iframe_id").addEventListener("load", function() {
    document.getElementById("loading").style.visibility='hidden';
    document.getElementById("Startsearch").className="btn btn-info";
    document.getElementById("Startsearch").innerHTML="Start Search";
    document.getElementById("Startsearch").disabled = false;
    alert("Search Done")
    });
  }
  
});
}

//CORS Proxy End
function query1 (data) {
  return _.chain(data)
    .orderBy(['unitPrice'], ['asc'])
    .map(item => ({
      "meterName": item?.meterName,
      "productName": item?.productName,
      "unitPrice": item?.unitPrice,
      "retailPrice": (Math.round((item?.retailPrice*730*100))/100).toFixed(2),
      "retailPrice1": (Math.round((item?.retailPrice*730*12*100))/100).toFixed(2),
      "retailPrice2": (Math.round((item?.retailPrice*720*12*3*100))/100).toFixed(2)
    }))
    .value()
}
//Windows License
function windowlicense(){
const url1 = "https://prices.azure.com/api/retail/prices?api-version=2023-01-01-preview&currencyCode='USD'&$filter=serviceName eq 'Virtual Machines Licenses' and contains(productName, 'Windows') eq true and unitPrice ne 0.0 and productName ne 'Windows Server for Azure Stack HCI'"

const cors = 'https://header-9dvg.onrender.com/';
document.getElementById("windowlicenseID").disabled = true;
document.getElementById("windowlicenseID").className="btn btn-dark";
document.getElementById("windowlicenseID").innerHTML="Searching";
document.getElementById("loading1").style.visibility='visible'
document.getElementById("jsonTableVM").remove();
$.get(`${cors}${url1}`, (res) => {
    const object1 = query1(res.Items)
    $(document).ready(function(){
      createTable(object1,"tablelistVM","jsonTableVM","Windows License Table");
      $('#jsonTableVM').bootstrapTable()
      document.getElementById("loading1").remove();
      document.getElementById("windowlicenseID").remove();
      
    });
  });
}
//Linux License
function linuxlicense(){
const url1 = "https://prices.azure.com/api/retail/prices?api-version=2023-01-01-preview&currencyCode='USD'&$filter=serviceName eq 'Virtual Machines Licenses' and contains(productName, 'Linux') eq true and unitPrice ne 0.0 and contains(productName, 'SQL') eq false and priceType ne 'Reservation'";
const cors = 'https://header-9dvg.onrender.com/';
document.getElementById("linuxlicenseID").disabled = true;
document.getElementById("linuxlicenseID").className="btn btn-dark";
document.getElementById("linuxlicenseID").innerHTML="Searching";
document.getElementById("loading2").style.visibility='visible'
document.getElementById("jsonTableVM1").remove();
$.get(`${cors}${url1}`, (res) => {
    const object1 = query1(res.Items)
    $(document).ready(function(){
      createTable(object1,"tablelistVM1","jsonTableVM1","Linux License Table");
      $('#jsonTableVM1').bootstrapTable()
      document.getElementById("loading2").remove();
      document.getElementById("linuxlicenseID").remove();
      
    });
  });
}
// export all table

function exporttable(){
  var table2excel = new Table2Excel();
  table2excel.export(document.querySelectorAll("table[id='jsonTableVM1'], table[id='jsonTableVM'], table[id='jsonTable']"), "Azure Price Cost Estimation");

}
//
$('#v-pills-tab a').on('click', function (e) {
  e.preventDefault()
  $(this).tab('show')
})

</script>
    
  </body>
</html>
